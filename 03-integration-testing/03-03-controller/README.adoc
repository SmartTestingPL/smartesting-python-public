= Kontroler / HTTP

== ğŸ Specyficzne dla Pythona ğŸ

W Pythonie najbliÅ¼szy odpowiednik kontrolera to... widok. W innych ekosystemach za widoki moÅ¼na by uznaÄ‡ za to nasze templatki.

Widok to funkcja wywoÅ‚ywana w reakcji na Å¼Ä…danie dla zadanego URLa i metody HTTP. Czasem potocznie okreÅ›la siÄ™ teÅ¼ tÄ… funkcjÄ™ "endpointem", chociaÅ¼ ta nazwa ma wiele znaczeÅ„ i nie jest do koÅ„ca poprawna w tym kontekÅ›cie.

PrzykÅ‚ad:
```python
@app.post("/fraudCheck", status_code=status.HTTP_200_OK)
def fraud_check_view():  # <- to nasz widok, wywoÅ‚ywany dla Å¼Ä…dania POST na /fraudCheck
    ...
```

Kiedy w materiaÅ‚ach napotkasz sÅ‚owo "kontroler", chodzi o widok. To pojÄ™cie jest uÅ¼ywane we wszystkich popularnych frameworkach w Pythonie.

== Kod

`smarttesting/client/fraud_view.py`

== Notatki

Zanim napiszemy jakikolwiek test, powinniÅ›my sobie zadaÄ‡ pytanie, co dokÅ‚adnie chcemy przetestowaÄ‡. Jaki jest cel naszego testu? W tym przypadku, mamy widok, czyli funkcjÄ™ przyjmujÄ…cÄ… Å¼Ä…dania HTTP i zwracajÄ…cy odpowiedÅº w tym protokole.

Mamy kilka moÅ¼liwoÅ›ci testowania widoku:
 - testowanie widoku jako funkcji,
 - testowanie widoku po warstwie HTTP z alokacjÄ… portu,
 - testowanie widoku po warstwie HTTP bez alokacji portu

RozwaÅ¼my teraz przypadki takich testÃ³w, jednak zobaczmy najpierw kod. PrzykÅ‚adem bÄ™dzie kod napisany w Pythonie z uÅ¼yciem FastAPI.

=== Testowanie widoku jako obiektu [01]

==== Klasy

`Test01Controller` i `TestModule` z pliku `tests/client/_01_controller_tests.py`

=== Testowanie widoku po warstwie HTTP z alokacjÄ… portu [02]

==== Klasy

`Test02FraudControllerWithPortBinding` i konieczna dla zrozumienia fikstura `tests.client.conftest.running_server`

=== Zamockowanie serwisu [03]

==== Klasy

`Test03FraudControllerWithFakeAndPortBinding` i klasa `PortControllerWithFake` z tego samego pliku `tests/client/_03_fraud_controller_with_fake_and_port_binding_tests.py`

=== Mockowanie warstwy sieciowej [04]

==== Klasy

`Test04TestClient`

=== Biblioteka do testowania API - Tavern [05]

==== Kod

`_05_tavern_api_tests.tavern.yaml` - caÅ‚kowicie deklaratywne podejÅ›cie w YAML
